<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Treed Studio Official</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Montserrat:wght@900&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #0d0d0d;
            --accent-blue: #00a3ff;
            --card-bg: #1c1c1c;
            --glass-border: rgba(255, 255, 255, 0.08);
            --text-main: #ffffff;
            --text-dim: #888888;
            --admin-red: #ff3b3b;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            color-scheme: dark;
        }

        /* --- ФОН --- */
        .bg-glow { position: fixed; top: -10%; left: 50%; transform: translateX(-50%); width: 100%; height: 50%; background: radial-gradient(circle, rgba(0, 163, 255, 0.12) 0%, transparent 70%); z-index: -1; }
        .bg-grid { position: fixed; top: 0; left: 0; width: 200%; height: 200%; background-image: linear-gradient(var(--glass-border) 1px, transparent 1px), linear-gradient(90deg, var(--glass-border) 1px, transparent 1px); background-size: 50px 50px; z-index: -1; opacity: 0.08; animation: moveGrid 50s linear infinite; }
        @keyframes moveGrid { from { background-position: 0 0; } to { background-position: 0 1000px; } }

        /* --- ХЕДЕР --- */
        header { padding: 20px; display: flex; justify-content: space-between; align-items: center; background: rgba(13, 13, 13, 0.85); backdrop-filter: blur(15px); border-bottom: 1px solid var(--glass-border); z-index: 100; }
        .logo { font-family: 'Montserrat'; font-weight: 900; color: #ffffff; font-size: 1.3rem; letter-spacing: -0.5px; }
        .user-info { display: flex; align-items: center; gap: 10px; }
        .user-info img { width: 32px; height: 32px; border-radius: 50%; border: 1.5px solid var(--accent-blue); }

        /* --- СТРАНИЦЫ --- */
        .page { flex: 1; padding: 20px; display: none; flex-direction: column; overflow-y: auto; z-index: 10; padding-bottom: 110px; animation: fadeIn 0.3s ease; }
        .page.active { display: flex; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } }

        /* --- КАРТОЧКИ --- */
        .list-item { background: var(--card-bg); border-radius: 24px; padding: 18px; display: flex; align-items: center; gap: 15px; margin-bottom: 12px; border: 1px solid var(--glass-border); position: relative;}
        .item-icon { width: 44px; height: 44px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 18px; color: white; background: var(--ic-color, #333); }
        .item-info { flex: 1; }
        .item-name { font-weight: 600; font-size: 15px; }
        .item-sub { font-size: 12px; color: var(--text-dim); line-height: 1.4; }

        /* СТАТИСТИКА */
        .stats-row { display: flex; gap: 10px; margin-bottom: 20px; }
        .stat-card { flex: 1; background: #161616; padding: 15px 10px; border-radius: 20px; text-align: center; border: 1px solid var(--glass-border); }
        .stat-card span { display: block; font-size: 18px; font-weight: 800; color: var(--accent-blue); }
        .stat-card p { font-size: 10px; color: var(--text-dim); text-transform: uppercase; }

        /* ЭТАПЫ РАБОТЫ */
        .workflow { margin-top: 10px; padding: 20px; background: rgba(255,255,255,0.02); border-radius: 24px; border: 1px dashed var(--glass-border); }
        .step { display: flex; gap: 15px; margin-bottom: 15px; }
        .step-num { color: var(--accent-blue); font-weight: 900; }
        .step-text b { display: block; font-size: 14px; color: #fff; }
        .step-text p { font-size: 12px; color: var(--text-dim); }

        /* ОТЗЫВЫ */
        .review-box { background: #111; padding: 15px; border-radius: 20px; border: 1px solid var(--glass-border); margin-bottom: 10px; position: relative; }
        .rev-header { color: var(--accent-blue); font-weight: 700; font-size: 0.85rem; }
        .rev-text { font-size: 0.85rem; color: #ccc; margin-top: 4px; }
        .del-btn { position: absolute; right: 15px; top: 15px; color: var(--admin-red); display: none; }

        /* АДМИН ПАНЕЛЬ */
        .admin-order { background: #1a1a1a; border-radius: 15px; padding: 15px; border-left: 4px solid var(--accent-blue); margin-bottom: 10px; }
        .admin-order b { color: var(--accent-blue); font-size: 14px; }
        .admin-order p { font-size: 12px; color: #eee; margin: 5px 0; }

        /* НАВИГАЦИЯ (DOCK) */
        .nav-bar { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); width: 92%; max-width: 450px; height: 70px; background: rgba(28, 28, 28, 0.95); backdrop-filter: blur(20px); border-radius: 35px; border: 1px solid var(--glass-border); display: flex; align-items: center; justify-content: space-around; z-index: 1000; }
        .nav-btn { display: flex; flex-direction: column; align-items: center; gap: 4px; color: #555; text-decoration: none; font-size: 10px; transition: 0.3s; flex: 1; }
        .nav-btn.active { color: #fff; }
        .nav-btn i { font-size: 20px; }
        .nav-btn.center { width: 65px; height: 65px; background: var(--accent-blue); border-radius: 50%; color: white; justify-content: center; transform: translateY(-20px); box-shadow: 0 0 25px rgba(0, 163, 255, 0.4); border: 5px solid var(--bg-color); flex: none; }
        #admin-tab { display: none; color: var(--admin-red); }

        /* КНОПКИ И МОДАЛКИ */
        .btn-main { width: 100%; padding: 18px; background: var(--accent-blue); color: white; border: none; border-radius: 18px; font-weight: 700; text-transform: uppercase; font-size: 0.9rem; outline: none; }
        .btn-main:disabled { background: #222; color: #555; }
        
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); backdrop-filter: blur(10px); display: none; justify-content: center; align-items: center; z-index: 2000; }
        .modal-box { width: 90%; max-width: 400px; background: #1a1a1a; padding: 30px; border-radius: 30px; border: 1px solid var(--glass-border); text-align: center; }
        
        input, select, textarea { width: 100%; background: #252525; border: 1px solid var(--glass-border); padding: 14px; border-radius: 16px; color: white; outline: none; margin-bottom: 12px; font-family: inherit; }
        .select-wrapper { position: relative; }
        .select-wrapper::after { content: '\f078'; font-family: 'Font Awesome 6 Free'; font-weight: 900; position: absolute; right: 15px; top: 18px; color: #555; font-size: 12px; pointer-events: none; }
        select { appearance: none; -webkit-appearance: none; }
    </style>
</head>
<body>

    <div class="bg-glow"></div>
    <div class="bg-grid"></div>

    <header>
        <div class="logo">TREED</div>
        <div class="user-info">
            <span id="u_name" style="color: #888; font-size: 0.8rem;">@username</span>
            <img id="u_pic" src="https://api.dicebear.com/7.x/shapes/svg?seed=Treed" alt="ava">
        </div>
    </header>

    <!-- ГЛАВНАЯ -->
    <main class="page active" id="p_home">
        <div class="stats-row">
            <div class="stat-card"><span>940+</span><p>Проектов</p></div>
            <div class="stat-card"><span>6 лет</span><p>В коде</p></div>
            <div class="stat-card"><span>100%</span><p>Гарантия</p></div>
        </div>
        <h3 style="margin-bottom: 15px; font-size: 16px;">Услуги студии</h3>
        <div class="list-item" style="--ic-color: #00a3ff;"><div class="item-icon"><i class="fas fa-robot"></i></div><div class="item-info"><div class="item-name">Telegram Bots</div><div class="item-sub">Автоматизация и ИИ системы</div></div></div>
        <div class="list-item" style="--ic-color: #f7931a;"><div class="item-icon"><i class="fas fa-th-large"></i></div><div class="item-info"><div class="item-name">Mini Apps</div><div class="item-sub">Приложения внутри Telegram</div></div></div>
        <div class="list-item" style="--ic-color: #627eea;"><div class="item-icon"><i class="fas fa-globe"></i></div><div class="item-info"><div class="item-name">Web Sites</div><div class="item-sub">Лендинги и CRM системы</div></div></div>
        <button class="btn-main" style="margin-top: 10px;" onclick="toggleModal('orderModal', true)">Оформить заказ</button>
    </main>

    <!-- ИНФО -->
    <main class="page" id="p_info">
        <h3 style="margin-bottom: 15px; font-size: 16px;">Условия работы</h3>
        <div class="list-item" style="--ic-color: #22c55e;"><div class="item-icon"><i class="fas fa-wallet"></i></div><div class="item-info"><div class="item-name">Оплата</div><div class="item-sub">После того как проект будет готов.</div></div></div>
        <div class="list-item" style="--ic-color: #eab308;"><div class="item-icon"><i class="fas fa-shield-alt"></i></div><div class="item-info"><div class="item-name">Гарантия</div><div class="item-sub">1 месяц. Любые правки бесплатно.</div></div></div>
        <div class="list-item" style="--ic-color: #ec4899;"><div class="item-icon"><i class="fas fa-server"></i></div><div class="item-info"><div class="item-name">Хостинг</div><div class="item-sub">Предоставляется от нас 24/7 бесплатно.</div></div></div>
        <div class="workflow">
            <h4 style="font-size: 13px; margin-bottom: 15px;">Как мы работаем:</h4>
            <div class="step"><div class="step-num">01</div><div class="step-text"><b>ТЗ</b><p>Обсуждаем детали и цену.</p></div></div>
            <div class="step"><div class="step-num">02</div><div class="step-text"><b>Код</b><p>Разработка и дизайн.</p></div></div>
            <div class="step"><div class="step-num">03</div><div class="step-text"><b>Тест</b><p>Проверка на ошибки.</p></div></div>
            <div class="step"><div class="step-num">04</div><div class="step-text"><b>Пуск</b><p>Передача и запуск.</p></div></div>
        </div>
    </main>

    <!-- ОТЗЫВЫ -->
    <main class="page" id="p_rev">
        <div id="rev_container">
            <div class="review-box" id="r-default"><div class="rev-header">Система</div><div class="rev-text">Добро пожаловать в Studio Treed!</div></div>
        </div>
        <div class="leave-rev-section">
            <textarea id="rev_input" rows="3" placeholder="Ваш отзыв..."></textarea>
            <button class="btn-main" id="rev_btn" onclick="postReview()">Опубликовать</button>
            <p id="timer" style="color: #ff4a4a; font-size: 11px; text-align: center; margin-top: 10px; display: none;"></p>
        </div>
    </main>

    <!-- АДМИН -->
    <main class="page" id="p_admin">
        <h3 style="margin-bottom: 20px;">Список заказов</h3>
        <div id="admin_orders">
            <p style="color: #555; text-align: center;">Заказов пока нет</p>
        </div>
    </main>

    <!-- НАВИГАЦИЯ -->
    <nav class="nav-bar">
        <a href="#" class="nav-btn" onclick="switchPage('p_info', this)"><i class="fas fa-info-circle"></i><span>Инфо</span></a>
        <a href="#" class="nav-btn center active" onclick="switchPage('p_home', this)"><i class="fas fa-home"></i></a>
        <a href="#" class="nav-btn" onclick="switchPage('p_rev', this)"><i class="fas fa-star"></i><span>Отзывы</span></a>
        <a href="#" id="admin-tab" class="nav-btn" onclick="switchPage('p_admin', this)"><i class="fas fa-user-shield"></i><span>Админ</span></a>
    </nav>

    <!-- МОДАЛКА ЗАКАЗА -->
    <div class="modal" id="orderModal">
        <div class="modal-box">
            <h3 style="margin-bottom:20px">Новый заказ</h3>
            <textarea id="tz" rows="4" placeholder="Описание ТЗ..."></textarea>
            <div style="display:flex; gap:10px">
                <input type="number" id="budget" placeholder="Бюджет" style="flex:2">
                <div class="select-wrapper" style="flex:1.5"><select id="curr"><option>RUB</option><option>TON</option><option>USDT</option><option>Stars</option></select></div>
            </div>
            <button class="btn-main" onclick="sendOrder()">Отправить</button>
            <div style="text-align:center; margin-top:15px; color:#555; font-size:13px" onclick="toggleModal('orderModal', false)">Закрыть</div>
        </div>
    </div>

    <!-- ОКНО УСПЕХА -->
    <div class="modal" id="successModal">
        <div class="modal-box">
            <i class="fas fa-check-circle" style="font-size: 50px; color: #22c55e; margin-bottom: 20px;"></i>
            <h3 style="margin-bottom: 10px;">Заявка принята</h3>
            <p style="font-size: 14px; color: #ccc; line-height: 1.5;">Ваш заказ успешно отправлен, Ожидайте с вами свяжется Treed в ближайшее время</p>
            <button class="btn-main" style="margin-top: 25px;" onclick="toggleModal('successModal', false)">Понятно</button>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        const ADMIN_USER = 'treedexe'; 
        const LIMIT = 5 * 60 * 60 * 1000;
        tg.expand();

        const user = tg.initDataUnsafe?.user;
        const isAdmin = user && user.username === ADMIN_USER;
        let nick = user ? (user.username ? `@${user.username}` : user.first_name) : "Guest";
        
        document.getElementById('u_name').innerText = nick;
        if(user?.photo_url) document.getElementById('u_pic').src = user.photo_url;

        if(isAdmin) {
            document.getElementById('admin-tab').style.display = 'flex';
        }

        function switchPage(pId, el) {
            tg.HapticFeedback.impactOccurred('light');
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(pId).classList.add('active');
            el.classList.add('active');
            if(pId === 'p_rev') {
                updateTimer();
                if(isAdmin) document.querySelectorAll('.del-btn').forEach(b => b.style.display = 'block');
            }
        }

        function toggleModal(id, show) {
            tg.HapticFeedback.impactOccurred('medium');
            document.getElementById(id).style.display = show ? 'flex' : 'none';
        }

        function postReview() {
            const inp = document.getElementById('rev_input');
            if(!inp.value.trim()) return;
            const id = 'r' + Date.now();
            const box = document.createElement('div');
            box.className = 'review-box';
            box.id = id;
            box.innerHTML = `<div class="rev-header">${nick}</div><div class="rev-text">${inp.value}</div>
            <i class="fas fa-trash del-btn" style="display:${isAdmin?'block':'none'}" onclick="deleteReview('${id}')"></i>`;
            document.getElementById('rev_container').prepend(box);
            inp.value = "";
            localStorage.setItem('last_rev_treed', Date.now());
            tg.HapticFeedback.notificationOccurred('success');
            updateTimer();
        }

        function deleteReview(id) {
            tg.showConfirm("Удалить отзыв?", (ok) => { if(ok) document.getElementById(id).remove(); });
        }

        const orders = [];
        function sendOrder() {
            const tz = document.getElementById('tz').value;
            const bud = document.getElementById('budget').value;
            const cur = document.getElementById('curr').value;
            if(!tz || !bud) return tg.showAlert("Заполните поля!");

            // Сохраняем в список админа
            const order = { user: nick, tz: tz, price: `${bud} ${cur}`, time: new Date().toLocaleTimeString() };
            orders.push(order);
            renderAdmin();

            tg.HapticFeedback.notificationOccurred('success');
            
            // Скрываем форму заказа и показываем окно успеха
            toggleModal('orderModal', false);
            setTimeout(() => {
                toggleModal('successModal', true);
            }, 300);
        }

        function renderAdmin() {
            const cont = document.getElementById('admin_orders');
            if(!orders.length) return;
            cont.innerHTML = '';
            orders.forEach(o => {
                const div = document.createElement('div');
                div.className = 'admin-order';
                div.innerHTML = `<b>${o.user}</b><p>${o.tz}</p><small>${o.price} | ${o.time}</small>`;
                cont.prepend(div);
            });
        }

        function updateTimer() {
            const last = localStorage.getItem('last_rev_treed');
            const btn = document.getElementById('rev_btn');
            const txt = document.getElementById('timer');
            if(!last || isAdmin) return;
            const run = () => {
                const diff = Date.now() - parseInt(last);
                if(diff < LIMIT) {
                    btn.disabled = true; txt.style.display = 'block';
                    const rem = LIMIT - diff;
                    const h = Math.floor(rem / 3600000), m = Math.floor((rem % 3600000) / 60000), s = Math.floor((rem % 60000) / 1000);
                    txt.innerText = `Повтор через: ${h}:${m < 10 ? '0'+m : m}:${s < 10 ? '0'+s : s}`;
                    setTimeout(run, 1000);
                } else { btn.disabled = false; txt.style.display = 'none'; }
            };
            run();
        }
        updateTimer();
    </script>
</body>
</html>